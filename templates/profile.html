{% extends "base.html" %}
{% block content %}

    <div class="events-wrapper swim-bg-lgrey">
        <!-- Intro & Add Event Button -->
        <div class="intro-div swim-bg-grey swim-txt-dblue div-shadow">
            <h1 class="font-title weight-600">{{ username|upper }}'S PROFILE</h1>
            <div class="font-body weight-500 intro-div-p-group">
                <p>Edit or delete your events using the buttons below. Or why not create a new one?</p>
            </div>
            <a href="{{ url_for('add_event')}}" class="swim-btn-large btn-hpink font-title weight-600 swim-btn-shadow">ADD EVENT</a>
        </div>

        <!-- Event Summary Cards -->
        <div class="events-div" id="events-div">
            {% for event in events %}
                {% if session.user|lower == event.created_by|lower %}
                    <div class="event-card">
                        {% for location in locations %}
                            {% if event.location_id == location._id %}
                                <div class="event-card-clickable swim-bg-white swim-txt-dblue">
                                    <a href="#"><span class="card-link"></span></a>
                                    <div class="event-image">
                                        <img src="{{ location.image_url }}" alt="Image of {{ location.name }}">
                                    </div>
                                    <div class="event-card-text center-align">
                                        <h2 class="font-title center-align weight-600 uppercase">{{ event.name }}</h2>
                                        <em><p class="font-body center-align weight-200 created-by">Created by: {{ event.created_by }}</p></em>
                                        <p class="font-body weight-700 uppercase"><i class="fa-solid fa-location-dot"></i></i>{{ location.name }}</p>
                                        <div class="event-when-row">
                                            <p class="font-body weight-500 uppercase"><i class="fa-regular fa-calendar"></i>{{ event.date.strftime('%d/%m/%y') }}</p>
                                            <p class="font-body weight-500 uppercase"><i class="fa-regular fa-clock"></i>{{ event.date.strftime('%H:%M') }}</p>
                                        </div>
                                    </div>
                                    <div class="event-marker-row uppercase">
                                        <p class="font-body weight-500 swim-txt-white event-marker swim-bg-{{event.who|lower}}">{{ event.who }}</p>
                                        <p class="font-body weight-500 swim-txt-black event-marker swim-bg-{{event.challenge|lower}}">{{ event.challenge }}</p>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}   
                                

                        <!-- Add CRUD control buttons if user event -->
                        {% if session.user|lower == event.created_by|lower or session.user|lower == "admin"|lower %}
                            <div class="card-edit-div swim-bg-dblue">
                                <a href="#" class="swim-btn-small btn-edit font-title swim-txt-white weight-400 swim-btn-shadow">EDIT</a>
                                <a href="#" class="swim-btn-small btn-delete font-title swim-txt-white weight-400 swim-btn-shadow">DELETE</a>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <div class="btt-btn-div">
            <button class="swim-btn-flexi btn-hpink font-title weight-500 swim-btn-shadow center-align" id="btt-btn">BACK TO TOP</button>
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/scroll-top.js') }}"></script>
{% endblock %}